<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>认识JWT | opvow's notebook</title><meta name="author" content="opvow"><meta name="copyright" content="opvow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="什么是JWTJWT(json web token)是用于系统之间发送加密签名的JSON数据的标准化格式(载荷可以是字符串或json数据)，作为身份认证、会话处理和访问控制机制的一部分与传统的会话令牌不同，服务器所需要的数据存储在jwt本身的客户端 JWT格式JWT由三部分组成，头部，载荷，签名，每个部分通过点连接header.payload.signature 1eyJraWQiOiI5MTM2Z">
<meta property="og:type" content="article">
<meta property="og:title" content="认识JWT">
<meta property="og:url" content="https://opvow.github.io/posts/cf3c54f2.html">
<meta property="og:site_name" content="opvow&#39;s notebook">
<meta property="og:description" content="什么是JWTJWT(json web token)是用于系统之间发送加密签名的JSON数据的标准化格式(载荷可以是字符串或json数据)，作为身份认证、会话处理和访问控制机制的一部分与传统的会话令牌不同，服务器所需要的数据存储在jwt本身的客户端 JWT格式JWT由三部分组成，头部，载荷，签名，每个部分通过点连接header.payload.signature 1eyJraWQiOiI5MTM2Z">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://opvow.github.io/img/post_cover/default.png">
<meta property="article:published_time" content="2024-10-29T05:11:52.000Z">
<meta property="article:modified_time" content="2024-12-07T10:13:51.942Z">
<meta property="article:author" content="opvow">
<meta property="article:tag" content="JWT Vulnerabilitiy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://opvow.github.io/img/post_cover/default.png"><link rel="shortcut icon" href="/img/icon.png"><link rel="canonical" href="https://opvow.github.io/posts/cf3c54f2.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: {"appId":"JSDCHS7HRY","apiKey":"7905d4770ae8e43c9aed23717e98e0a2","indexName":"search","hitsPerPage":6,"languages":{"input_placeholder":"搜索文章","hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，耗时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":600,"languages":{"author":"作者: opvow","link":"链接: ","source":"来源: opvow's notebook","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-center"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: false,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '认识JWT',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="../css/loading.css?1"><link rel="stylesheet" href="../css/social_iconfont.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/img/background.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-image"></i><span> 图库</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background: transparent;"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">opvow's notebook</span></a><a class="nav-page-title" href="/"><span class="site-name">认识JWT</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/images/"><i class="fa-fw fas fa-image"></i><span> 图库</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">认识JWT</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-10-29T05:11:52.000Z" title="发表于 2024-10-29 13:11:52">2024-10-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-12-07T10:13:51.942Z" title="更新于 2024-12-07 18:13:51">2024-12-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Web%E5%AE%89%E5%85%A8/">Web安全</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="什么是JWT"><a href="#什么是JWT" class="headerlink" title="什么是JWT"></a>什么是JWT</h1><p>JWT(json web token)是用于系统之间发送加密签名的JSON数据的标准化格式(载荷可以是字符串或json数据)，作为身份认证、会话处理和访问控制机制的一部分<br>与传统的会话令牌不同，服务器所需要的数据存储在jwt本身的客户端</p>
<h1 id="JWT格式"><a href="#JWT格式" class="headerlink" title="JWT格式"></a>JWT格式</h1><p>JWT由三部分组成，头部，载荷，签名，每个部分通过点连接<br>header.payload.signature</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJraWQiOiI5MTM2ZGRiMy1jYjBhLTRhMTktYTA3ZS1lYWRmNWE0NGM4YjUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTY0ODAzNzE2NCwibmFtZSI6IkNhcmxvcyBNb250b3lhIiwic3ViIjoiY2FybG9zIiwicm9sZSI6ImJsb2dfYXV0aG9yIiwiZW1haWwiOiJjYXJsb3NAY2FybG9zLW1vbnRveWEubmV0IiwiaWF0IjoxNTE2MjM5MDIyfQ.</span><br></pre></td></tr></table></figure>
<p>JWT的头部和载荷部分是base64url编码的json对象，头部包含令牌本身的元数据，载荷包含用户的声明，例如上述部分解码如下：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">header<span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;kid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;9136ddb3-cb0a-4a19-a07e-eadf5a44c8b5&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RS256&quot;</span><span class="punctuation">,</span> <span class="comment">//使用的算法</span></span><br><span class="line">  <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span> <span class="comment">//令牌类型</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">payload<span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;iss&quot;</span><span class="punctuation">:</span> <span class="string">&quot;portswigger&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;exp&quot;</span><span class="punctuation">:</span> <span class="number">1648037164</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Carlos Montoya&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;carlos&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;blog_author&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;email&quot;</span><span class="punctuation">:</span> <span class="string">&quot;carlos@carlos-montoya.net&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1516239022</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">signature<span class="punctuation">:</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    RSASHA256(</span><br><span class="line">    base64UrlEncode(header) + <span class="string">&quot;.&quot;</span> +</span><br><span class="line">    base64UrlEncode(payload)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>正如上面部分的编码，任何有权访问jwt令牌的人都可以解码读取或修改这部分数据，因此基于jwt机制的安全性严重依赖于第三部分的加密签名</p>
<h1 id="jwt签名"><a href="#jwt签名" class="headerlink" title="jwt签名"></a>jwt签名</h1><p>发出jwt令牌的服务器通过header和payload进行生成签名，某些情况下还会加密哈希，无论哪种方式都会涉及密钥，这种机制为服务器提供了一种验证令牌数据是否有被篡改。即：<br>签名通过header和payload产生，若前两部分遭到修改则导致签名不匹配<br>若不知道密钥，则无法为header和payload生成正确的签名</p>
<h1 id="jwt-jws-jwe"><a href="#jwt-jws-jwe" class="headerlink" title="jwt&#x2F;jws&#x2F;jwe"></a>jwt&#x2F;jws&#x2F;jwe</h1><p>以如下json数据为例：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mondo&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="JWT"><a href="#JWT" class="headerlink" title="JWT"></a>JWT</h2><p>JWT（JSON Web Token）<br>定义：JWT 是一种开放标准（RFC 7519），用于传输声明（Claims）和数据的安全 JSON 格式。它通常用于身份验证和授权，尤其是在单点登录（SSO）系统中<br>结构：JWT 是由三部分组成的：头部（Header）、有效载荷（Payload）和签名（Signature），在<strong>没有签名或加密</strong>的情况下，JWT 只包含未加密的数据</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;header&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;payload&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mondo&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HMACSHA256(base64UrlEncode(header) + &#x27;.&#x27; + base64UrlEncode(payload), secret)&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>头部（Header）：通常会包含签名算法，如 HMAC SHA256 或 RSA<br>有效载荷（Payload）：包含声明信息{“sub”: “1234567890”, “name”: “mondo”}，可以是公开的<br>签名（Signature）：基于 header 和 payload 使用密钥签名，通常是一个秘密密钥 secret<br>由此生成的数据：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJzdWIiOiAiMTIzNDU2Nzg5MCIsICJuYW1lIjogIm1vbmRvIn0.HMACSHA256(encoded_header_and_payload<span class="punctuation">,</span> secret)</span><br></pre></td></tr></table></figure>
<p>应用场景：JWT 通常用于 Web 服务之间的认证和授权，比如 OAuth 2.0 中的访问令牌<br>注意：JWT 是一种“令牌”格式，通常通过 Base64 编码进行传输</p>
<h2 id="JWS"><a href="#JWS" class="headerlink" title="JWS"></a>JWS</h2><p>JWS（JSON Web Signature）<br>定义：JWS 是一种用于签名数据的标准，允许你将 JWT 数据进行签名，使其可以被验证其真实性和完整性。它是 JWT 的一种签名形式。<br>结构：JWS 也是由三部分组成：头部（Header）、有效载荷（Payload）和签名（Signature）。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;protected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的 Header</span></span><br><span class="line">  <span class="attr">&quot;payload&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eyJzdWIiOiAiMTIzNDU2Nzg5MCIsICJuYW1lIjogIm1vbmRvIn0&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的 Payload</span></span><br><span class="line">  <span class="attr">&quot;signature&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HMACSHA256(base64UrlEncode(header) + &#x27;.&#x27; + base64UrlEncode(payload), secret)&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>头部（Header）：包含签名算法和类型信息（如 JWS）。<br>有效载荷（Payload）：这是被签名的数据，可以是任何内容（JSON 对象、字符串等）。<br>签名（Signature）：基于头部的签名算法和密钥对有效载荷进行签名，确保数据未被篡改。<br>应用场景：JWS 是一种签名机制，通常用于确保消息的完整性，防止被篡改。例如，OAuth 2.0 的 ID Token 是通过 JWS 签名的。</p>
<h2 id="JWE"><a href="#JWE" class="headerlink" title="JWE"></a>JWE</h2><p>JWE（JSON Web Encryption）<br>格式：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header.encrypted_key.iv.ciphertext.tag</span><br></pre></td></tr></table></figure>
<p>定义：JWE 是一种用于加密数据的标准，它允许将 JSON 格式的数据进行加密。与 JWS 不同，JWE 主要关注数据加密而非签名。<br>结构：JWE 包含五部分：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJFUzI1NiIsImtpZCI6IkpXRUtleTFAIn0.YWN0aW9uX2tleV9jb2RlX3ZhbHVl.Rm9vQmF6.cGF5bG9hZG9jb25jdW5jdA==.c3RhY2tlZGtleQ==</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;protected&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eyJhbGciOiAiUlNBLTI1NiIsImtpZCI6ICJXc3JuaW5nQ29kZUl3In0&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的 Header</span></span><br><span class="line">  <span class="attr">&quot;encrypted_key&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Y2VydC1rZXk=&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的加密密钥</span></span><br><span class="line">  <span class="attr">&quot;iv&quot;</span><span class="punctuation">:</span> <span class="string">&quot;d2luZA==&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的 IV</span></span><br><span class="line">  <span class="attr">&quot;ciphertext&quot;</span><span class="punctuation">:</span> <span class="string">&quot;bm9uY2UgaW4gdGVzdCBkYXRh&quot;</span><span class="punctuation">,</span>  <span class="comment">// Base64 编码的加密内容</span></span><br><span class="line">  <span class="attr">&quot;tag&quot;</span><span class="punctuation">:</span> <span class="string">&quot;U0QzNzgx&quot;</span>  <span class="comment">// Base64 编码的认证标签</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>保护头部（Header）：指示加密算法和加密类型。<br>加密密钥（Key）：用于加密内容的对称密钥。<br>初始化向量（IV）：用于加密算法的随机数据。<br>加密内容（Ciphertext）：实际加密的数据（有效载荷）。<br>认证标签（Authentication Tag）：用于验证数据完整性和防止篡改。<br>应用场景：JWE 用于保护传输中的数据不被未授权方读取，它通过加密有效载荷确保数据的机密性。适用于需要加密传输的场景。</p>
<h3 id="JWE生成"><a href="#JWE生成" class="headerlink" title="JWE生成"></a>JWE生成</h3><p>生成AES密钥<br>使用对称密钥CEK(content encryption key)对消息内容加密，常见对称密钥是AES，通常有 AES-128、AES-192 或 AES-256</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成一个 256 位的 AES 密钥</span></span><br><span class="line">cek = get_random_bytes(<span class="number">32</span>)  <span class="comment"># 32 字节 = 256 位 AES 密钥</span></span><br></pre></td></tr></table></figure>
<p>密钥封装<br>当CEK生成时，需要接收方的公钥加密CEK密钥，通常使用RSA对CEK加密，密钥封装算法可以是RSAES-PKCS1-v1_5、RSA-OAEP等，根据JWE的头部设置</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载公钥 (假设 `public_key` 是接收方的公钥)</span></span><br><span class="line">rsa_key = RSA.import_key(public_key_pem)</span><br><span class="line">cipher_rsa = PKCS1_OAEP.new(rsa_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 RSA 公钥加密 CEK</span></span><br><span class="line">encrypted_key = cipher_rsa.encrypt(cek)</span><br></pre></td></tr></table></figure>
<p>内容加密<br>使用生成的CEK对内容进行加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机的 IV（初始化向量）</span></span><br><span class="line">iv = get_random_bytes(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 AES-GCM 加密内容</span></span><br><span class="line">cipher = AES.new(cek, AES.MODE_GCM, nonce=iv)</span><br><span class="line">ciphertext, tag = cipher.encrypt_and_digest(plaintext.encode())</span><br></pre></td></tr></table></figure>
<p>构建JWE<br>将有关加密的部分如加密使用的密钥AES，加密的消息，加密随机向量IV等组合为一个JWE的格式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">jwe = &#123;</span><br><span class="line">    <span class="string">&quot;protected&quot;</span>: base64.urlsafe_b64encode(<span class="string">b&#x27;&#123;&quot;alg&quot;: &quot;RSA-OAEP&quot;, &quot;enc&quot;: &quot;A256GCM&quot;&#125;&#x27;</span>).decode(),</span><br><span class="line">    <span class="string">&quot;encrypted_key&quot;</span>: base64.urlsafe_b64encode(encrypted_key).decode(),</span><br><span class="line">    <span class="string">&quot;iv&quot;</span>: base64.urlsafe_b64encode(iv).decode(),</span><br><span class="line">    <span class="string">&quot;ciphertext&quot;</span>: base64.urlsafe_b64encode(ciphertext).decode(),</span><br><span class="line">    <span class="string">&quot;tag&quot;</span>: base64.urlsafe_b64encode(tag).decode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">jwe_str = json.dumps(jwe)</span><br></pre></td></tr></table></figure>
<p>完整代码:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> padding <span class="keyword">as</span> asymmetric_padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"></span><br><span class="line"><span class="comment"># Base64 URL 编码函数（不使用 &#x27;=&#x27; 填充）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_url_encode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> base64.urlsafe_b64encode(data).rstrip(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成随机对称密钥（用于 AES 加密）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_symmetric_key</span>():</span><br><span class="line">    <span class="keyword">return</span> os.urandom(<span class="number">32</span>)  <span class="comment"># 生成 256 位密钥，用于 AES</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成初始化向量 IV</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_iv</span>():</span><br><span class="line">    <span class="keyword">return</span> os.urandom(<span class="number">12</span>)  <span class="comment"># AES GCM 模式通常使用 12 字节的 IV</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 公钥加密对称密钥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_with_rsa</span>(<span class="params">symmetric_key, public_key</span>):</span><br><span class="line">    encrypted_key = public_key.encrypt(</span><br><span class="line">        symmetric_key,</span><br><span class="line">        asymmetric_padding.OAEP(</span><br><span class="line">            mgf=asymmetric_padding.MGF1(algorithm=hashes.SHA256()),</span><br><span class="line">            algorithm=hashes.SHA256(),</span><br><span class="line">            label=<span class="literal">None</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> encrypted_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 AES 加密数据</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_with_aes</span>(<span class="params">data, symmetric_key, iv</span>):</span><br><span class="line">    <span class="comment"># 先进行数据填充</span></span><br><span class="line">    padder = padding.PKCS7(algorithms.AES.block_size).padder()</span><br><span class="line">    padded_data = padder.update(data) + padder.finalize()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用 AES GCM 加密模式</span></span><br><span class="line">    cipher = Cipher(algorithms.AES(symmetric_key), modes.GCM(iv), backend=default_backend())</span><br><span class="line">    encryptor = cipher.encryptor()</span><br><span class="line">    ciphertext = encryptor.update(padded_data) + encryptor.finalize()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 返回加密后的数据和认证标签</span></span><br><span class="line">    <span class="keyword">return</span> ciphertext, encryptor.tag</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例数据（JSON 格式数据）</span></span><br><span class="line">data_to_encrypt = json.dumps(&#123;</span><br><span class="line">    <span class="string">&quot;sub&quot;</span>: <span class="string">&quot;1234567890&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;mondo&quot;</span></span><br><span class="line">&#125;).encode()  <span class="comment"># 将 JSON 数据转换为字节字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 RSA 公钥</span></span><br><span class="line">public_key_pem = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">-----BEGIN RSA PUBLIC KEY-----</span></span><br><span class="line"><span class="string">MIIBCgKCAQEAxvltv9COc/jSfzJ8zbHroUzmFa2vVNLdv9KJn1BzyJhIN6xUdPXc</span></span><br><span class="line"><span class="string">4NMqp6cr8RFMnvsHkDzs4OUwozZnpkmzjgivW2/uFmUTGnE7hzt5Dq1pF/JmHREn</span></span><br><span class="line"><span class="string">oyyyBdhXPVCp4Xayd+ql8Jns4dEQxcqDrwv7VvIvRqvWo+rVY7mfNGCGrIww9/cj</span></span><br><span class="line"><span class="string">WMiiWLV6TtJwI7c+ro6RpCZ6bGAaujf6lLRdWNIin5Ya+HIuiGtcYaOsY04F+Nav</span></span><br><span class="line"><span class="string">fOigBbRJ7KjRDc9t+9aFMuuCNFAzP/Grj/yty/l4Fe5NwossSJKI9NKH5XBpkWkK</span></span><br><span class="line"><span class="string">iKYwt2hTNQ7Tqk/WTvbBwzgnqotCYnDLYwIDAQAB</span></span><br><span class="line"><span class="string">-----END RSA PUBLIC KEY-----</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">public_key = serialization.load_pem_public_key(public_key_pem.encode(), backend=default_backend())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 生成对称密钥</span></span><br><span class="line">symmetric_key = generate_symmetric_key()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 使用 RSA 公钥加密对称密钥</span></span><br><span class="line">encrypted_key = encrypt_with_rsa(symmetric_key, public_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 生成初始化向量 IV</span></span><br><span class="line">iv = generate_iv()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 使用 AES 加密数据</span></span><br><span class="line">ciphertext, tag = encrypt_with_aes(data_to_encrypt, symmetric_key, iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 构建 protected header</span></span><br><span class="line">protected_header = &#123;</span><br><span class="line">    <span class="string">&quot;alg&quot;</span>: <span class="string">&quot;RSA-OAEP&quot;</span>,  <span class="comment"># 公钥加密对称密钥算法</span></span><br><span class="line">    <span class="string">&quot;enc&quot;</span>: <span class="string">&quot;A256GCM&quot;</span>,   <span class="comment"># 对称加密算法，使用 AES GCM 模式</span></span><br><span class="line">    <span class="string">&quot;kid&quot;</span>: <span class="string">&quot;my-key-id&quot;</span>  <span class="comment"># 可选的密钥 ID</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. Base64 URL 编码所有部分</span></span><br><span class="line">protected_header_base64 = base64_url_encode(json.dumps(protected_header).encode())</span><br><span class="line">encrypted_key_base64 = base64_url_encode(encrypted_key)</span><br><span class="line">iv_base64 = base64_url_encode(iv)</span><br><span class="line">ciphertext_base64 = base64_url_encode(ciphertext)</span><br><span class="line">tag_base64 = base64_url_encode(tag)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 构建 JWE 令牌</span></span><br><span class="line">jwe_token = &#123;</span><br><span class="line">    <span class="string">&quot;protected&quot;</span>: protected_header_base64.decode(),</span><br><span class="line">    <span class="string">&quot;encrypted_key&quot;</span>: encrypted_key_base64.decode(),</span><br><span class="line">    <span class="string">&quot;iv&quot;</span>: iv_base64.decode(),</span><br><span class="line">    <span class="string">&quot;ciphertext&quot;</span>: ciphertext_base64.decode(),</span><br><span class="line">    <span class="string">&quot;tag&quot;</span>: tag_base64.decode()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 JWE 令牌</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;JWE Token:&quot;</span>, json.dumps(jwe_token, indent=<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<p>jwe解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> ciphers, padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> padding <span class="keyword">as</span> asymmetric_padding</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"></span><br><span class="line"><span class="comment"># Base64 URL 解码函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">base64_url_decode</span>(<span class="params">base64_url</span>):</span><br><span class="line">    base64_url = base64_url.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    padding = <span class="string">&#x27;=&#x27;</span> * (<span class="number">4</span> - <span class="built_in">len</span>(base64_url) % <span class="number">4</span>)  <span class="comment"># 计算需要的填充字符</span></span><br><span class="line">    <span class="keyword">return</span> base64.b64decode(base64_url + padding)</span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA 私钥解密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_rsa</span>(<span class="params">encrypted_key, private_key</span>):</span><br><span class="line">    <span class="keyword">return</span> private_key.decrypt(</span><br><span class="line">        encrypted_key,</span><br><span class="line">        asymmetric_padding.OAEP(</span><br><span class="line">            mgf=asymmetric_padding.MGF1(algorithm=hashes.SHA256()),</span><br><span class="line">            algorithm=hashes.SHA256(),</span><br><span class="line">            label=<span class="literal">None</span></span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># AES 解密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_aes</span>(<span class="params">ciphertext, key, iv, tag</span>):</span><br><span class="line">    <span class="comment"># 使用 AES GCM 模式解密数据</span></span><br><span class="line">    cipher = ciphers.Cipher(ciphers.algorithms.AES(key), ciphers.modes.GCM(iv, tag), backend=default_backend())</span><br><span class="line">    decryptor = cipher.decryptor()</span><br><span class="line">    decrypted_data = decryptor.update(ciphertext) + decryptor.finalize()</span><br><span class="line">    <span class="keyword">return</span> decrypted_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># JWE 数据</span></span><br><span class="line">jwe_token = &#123;</span><br><span class="line">    <span class="string">&quot;protected&quot;</span>: <span class="string">&quot;eyJhbGciOiAiUlNBLU9BRVAiLCAiZW5jIjogIkEyNTZHQ00iLCAia2lkIjogIm15LWtleS1pZCJ9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;encrypted_key&quot;</span>: <span class="string">&quot;uTkPLsJfUYVtl7zS9l7j0i1vbaSQFAWIQOJkuONkMACIZyqZGf8GP3dZh7cfdgfhd9OtVz3DJFAHru7bCgSSaY4NdA_UXd8AoI8LtMik0MPatwyzypZQuzdPJghVqaEuvEkJuayRIojM4ej_XPl0U3SO6tnvB3WZ-eHZzHBnZ_UJt-YlWlqJY6lSuLmnZBdxWG-nElcky7OS-26JSlcKtQ_mQNlX5HgWSQfCgvStgoAeokNEH2_RSkK4N0PbdOdSq4kcWNPkJqekmFyamx-e0ZmNP41BcgqNQwx8Y0hVzbLvQXuHfydpov7lTP956toB2UkDFsAyo26r3rjjbTTPAg&quot;</span>,</span><br><span class="line">    <span class="string">&quot;iv&quot;</span>: <span class="string">&quot;EDrRQTsDTfqxr19X&quot;</span>,</span><br><span class="line">    <span class="string">&quot;ciphertext&quot;</span>: <span class="string">&quot;vz-7xLP7z-JQTuPYzK_k0ZQoYtpQgmTiWwrDDKZAX4amNOM8DNTP-IibCPFhaPTs&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tag&quot;</span>: <span class="string">&quot;zbaVaXdjOMMGzgRpmUZdyw&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 解码 JWE 部分</span></span><br><span class="line">protected_header = json.loads(base64_url_decode(jwe_token[<span class="string">&#x27;protected&#x27;</span>]).decode())  <span class="comment"># 头部</span></span><br><span class="line">encrypted_key = base64_url_decode(jwe_token[<span class="string">&#x27;encrypted_key&#x27;</span>])  <span class="comment"># 解密密钥</span></span><br><span class="line">iv = base64_url_decode(jwe_token[<span class="string">&#x27;iv&#x27;</span>])  <span class="comment"># 初始化向量</span></span><br><span class="line">ciphertext = base64_url_decode(jwe_token[<span class="string">&#x27;ciphertext&#x27;</span>])  <span class="comment"># 密文</span></span><br><span class="line">tag = base64_url_decode(jwe_token[<span class="string">&#x27;tag&#x27;</span>])  <span class="comment"># 认证标签</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 加载私钥</span></span><br><span class="line">private_key_pem = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">-----BEGIN RSA PRIVATE KEY-----</span></span><br><span class="line"><span class="string">MIIEqQIBAAKCAQEAxvltv9COc/jSfzJ8zbHroUzmFa2vVNLdv9KJn1BzyJhIN6xU</span></span><br><span class="line"><span class="string">dPXc4NMqp6cr8RFMnvsHkDzs4OUwozZnpkmzjgivW2/uFmUTGnE7hzt5Dq1pF/Jm</span></span><br><span class="line"><span class="string">HREnoyyyBdhXPVCp4Xayd+ql8Jns4dEQxcqDrwv7VvIvRqvWo+rVY7mfNGCGrIww</span></span><br><span class="line"><span class="string">9/cjWMiiWLV6TtJwI7c+ro6RpCZ6bGAaujf6lLRdWNIin5Ya+HIuiGtcYaOsY04F</span></span><br><span class="line"><span class="string">+NavfOigBbRJ7KjRDc9t+9aFMuuCNFAzP/Grj/yty/l4Fe5NwossSJKI9NKH5XBp</span></span><br><span class="line"><span class="string">kWkKiKYwt2hTNQ7Tqk/WTvbBwzgnqotCYnDLYwIDAQABAoIBAQCy9rHx7uHSCaE6</span></span><br><span class="line"><span class="string">6uw6DqeDAymHohqrTqZI3FMQSkp5yA5clNG6CVHLneMlvETXpNmnvN3GrCXa+gnP</span></span><br><span class="line"><span class="string">IyYC+RNY0xL2SSx6VBrkk6gZMDLoMqzt7wZNapqeN5s/iqCc86p4skw/c3whdjEL</span></span><br><span class="line"><span class="string">wwE1Bbt/fGVqhJZlGDVI25ka3VQSd56uMfZbHXqOhbg/PW/jykykWOlNRgvfMOqP</span></span><br><span class="line"><span class="string">/XiAMDCXYXYwC9MOxEbA29E7bLhVkl1hpGUOIL3CvR0Oj6E8L/B0XDnxwfm+oRGj</span></span><br><span class="line"><span class="string">AMbH9+i3dTps09cHsdZ6Y5N9KhVuFdrEEVFaB2Biqo4IulaPOBQ+C/6qlFl5hOWf</span></span><br><span class="line"><span class="string">VPmVeR+xAoGJANlmvzrSO9R1tvfwRtXHQQgc+yKhFSljlVdYufIFqS+ay3MUlA8H</span></span><br><span class="line"><span class="string">TrOptY38dJLm1qqvuijZi+4m68ZV+9fM6mRvFCBBLN08I8uQ3vSoEhgqSROBU09T</span></span><br><span class="line"><span class="string">1005kXHcqIWIIHobNlIfpqi95lwAgQVlyg7gSG7F+Ak9l1p9NWyi3TCoy7Ix1Uld</span></span><br><span class="line"><span class="string">qycCeQDqTSSPwZo7UbtUUqBpoj3bDnRC6op1ZlDAPr0BtDkAyUWBZ8X6C9pTVXR5</span></span><br><span class="line"><span class="string">5BdWPb7HvOvHWbTDty961m9ejeyKy8oe8UYVO0CgKvYi8ZSDMh66MykSd7zV6APE</span></span><br><span class="line"><span class="string">64L8IKrsLuLOvogBwejKFkw9RkWyW8lmO+Gws2UCgYhNjAHwaGdhDLA8Vp/dx5ph</span></span><br><span class="line"><span class="string">23yVSKI0xknSA1sogm5sBapGnXOGvNOM8J9LS18Fu4OdFNuxkJACXi3B7I/N1VFS</span></span><br><span class="line"><span class="string">i/DA5J6tN7OI/F8bJAx4RDUW2Q2vgTeOW1ePJueR4hG7nJNOze1zyXEvJhrfowRl</span></span><br><span class="line"><span class="string">NAmCQemM2kRvybPR0XJW1g76vB3ZcqkHAnhtuEZg04bINJQG/tKD5SgWRwSGuZKx</span></span><br><span class="line"><span class="string">O4KhJEAaZi0zgw17df8uAxLwZ1ouInQTPML0gjHfntCZvlULrxNkMg4NSTWTm+T3</span></span><br><span class="line"><span class="string">2FGBL90nq/2iGnxtMbwQG+ZgPVBWjPs/2oRwKdyoeGz0dbvvttVo9Fl7FqSPrYcY</span></span><br><span class="line"><span class="string">2kkCgYh/T+HSWYhH/liybvrA7WRSRZnpPq+zh6yCkI5c6y/gj7Il54N3AWp3+E3n</span></span><br><span class="line"><span class="string">74w+IKd1xIneqeCccq91sG9woDdbVv0Rt0e4HNDc7IEVqkwQxwN6ZUrrm+wHlU1A</span></span><br><span class="line"><span class="string">LJA4CGy/HOVdjCY+pX/f0JIWlJLEPpvAskXaKyQioyKPdDbX1mTi/cHWdAHt</span></span><br><span class="line"><span class="string">-----END RSA PRIVATE KEY-----</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">private_key = serialization.load_pem_private_key(private_key_pem.encode(), password=<span class="literal">None</span>, backend=default_backend())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 解密对称密钥</span></span><br><span class="line">symmetric_key = decrypt_with_rsa(encrypted_key, private_key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 使用 AES 解密密文</span></span><br><span class="line">decrypted_data = decrypt_with_aes(ciphertext, symmetric_key, iv, tag)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的数据:&quot;</span>, decrypted_data.decode())</span><br></pre></td></tr></table></figure>
<h1 id="JWT攻击"><a href="#JWT攻击" class="headerlink" title="JWT攻击"></a>JWT攻击</h1><h2 id="算法攻击"><a href="#算法攻击" class="headerlink" title="算法攻击"></a>算法攻击</h2><p>算法混淆<br>(如果服务器配置了hs256的共享密钥且你能爆破成功实现对header和payload签名)<br>JWT令牌中可以使用不同的签名算法，例如HS256（HMAC）和RS256（RSA）。攻击者可以尝试通过修改算法字段（如将RS256改为HS256），然后使用共享密钥来验证JWT，这可能导致令牌的验证失败或错误地接受不可信的令牌。<br>None算法<br>某些JWT库没有正确处理None算法（表示没有签名）。攻击者可以尝试将签名算法alg的值改为None，并移除签名部分，利用服务端的验证逻辑漏洞来绕过验证。</p>
<h2 id="密钥泄露"><a href="#密钥泄露" class="headerlink" title="密钥泄露"></a>密钥泄露</h2><p>使用已知的JWT签名算法（如HS256），攻击者可以尝试猜测密钥并生成有效的令牌。</p>
<h2 id="令牌篡改"><a href="#令牌篡改" class="headerlink" title="令牌篡改"></a>令牌篡改</h2><p>JWT令牌的有效性是通过签名进行验证的，如果没有正确配置密钥或算法，攻击者可以篡改令牌的负载部分（如用户ID、权限等），并使用篡改后的令牌伪造身份。</p>
<h2 id="exp绕过"><a href="#exp绕过" class="headerlink" title="exp绕过"></a>exp绕过</h2><p>JWT令牌中通常会包含过期时间（exp）。如果令牌未正确处理过期时间，攻击者可能会修改令牌中的exp字段，使其延长有效期，从而绕过过期时间限制。</p>
<h2 id="token重放"><a href="#token重放" class="headerlink" title="token重放"></a>token重放</h2><p>攻击者获取JWT令牌后，可能会在令牌过期之前反复使用它（如利用长时间的会话保持），从而进行会话劫持。</p>
<h2 id="不安全的存储"><a href="#不安全的存储" class="headerlink" title="不安全的存储"></a>不安全的存储</h2><p>如果JWT令牌在客户端（如浏览器）中存储不当（例如存储在localStorage或sessionStorage中），攻击者可能通过XSS攻击窃取令牌。</p>
<h2 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a>信息泄露</h2><p>虽然JWT令牌本身经过加密或签名，但如果负载部分（如用户身份信息、权限等）没有加密或不小心暴露，攻击者可以直接读取其中的信息，进行数据泄露攻击。<br><a target="_blank" rel="noopener" href="https://portswigger.net/web-security/jwt">PortSwigger-JWT靶场</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://opvow.github.io">opvow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://opvow.github.io/posts/cf3c54f2.html">https://opvow.github.io/posts/cf3c54f2.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://opvow.github.io" target="_blank">opvow's notebook</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/JWT-Vulnerabilitiy/">JWT Vulnerabilitiy</a></div><div class="post-share"><div class="social-share" data-image="/img/post_cover/default.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/posts/962f5710.html" title="Portswigger-JWT-LAB-1"><img class="cover" src="/img/post_cover/default.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">Portswigger-JWT-LAB-1</div></div><div class="info-2"><div class="info-item-1">未经验证的签名绕过JWT身份验证未经验证的签名，即修改载荷发送至服务端不会对算法和签名进行验证从而绕过JWT身份认证 题目信息用户凭证: wiener:peter 题目要求 修改会话令牌以访问&#x2F;admin处的管理面板，并删除用户carlos 解题靶场页面登录页面登录抓包返回jwt令牌数据查看jwt详细数据抓包，访问My account功能点修改接口admin:GET &#x2F;my-account?id&#x3D;wiener为admin:GET &#x2F;admin，出现错误，显示:管理员界面仅在以管理员身份登录时可用修改sub值为admin或administrator成功删除carlos(点击删除还会对jwt令牌认证，再次抓包修改jwt的sub值为administrator即可) </div></div></div></a><a class="pagination-related" href="/posts/d0e26b4a.html" title="Portswigger-JWT-LAB-3"><img class="cover" src="/img/post_cover/default.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">Portswigger-JWT-LAB-3</div></div><div class="info-2"><div class="info-item-1">通过弱签名密钥绕过JWT身份验证当jwt令牌使用了一个弱的密钥进行签名和验证令牌，可以通过对密钥暴力破解获取加密密钥并对修改过的header和payload进行签名 题目信息用户凭证: wiener:peter 题目要求 修改会话令牌以访问&#x2F;admin处的管理面板，并删除用户carlos 解题还是原来的数据包修改jwt令牌数据，但这次需要爆破出弱密钥并对头部和payload签名可以使用hashcat或jwt_tools弱密钥爆破，hashcat对电脑cpu和gpu要求较高。 1hashcat -m 16500 -a 0...</div></div></div></a><a class="pagination-related" href="/posts/a7e55bdc.html" title="Portswigger-JWT-LAB-2"><img class="cover" src="/img/post_cover/default.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">Portswigger-JWT-LAB-2</div></div><div class="info-2"><div class="info-item-1">通过有缺陷的签名验证绕过JWT身份验证服务器被不安全地配置为接受未签名的JWT，即通过修改alg为none并删除签名即可绕过 题目信息用户凭证: wiener:peter 题目要求 修改会话令牌以访问&#x2F;admin处的管理面板，并删除用户carlos 解题思路还是一样，使用jwt令牌修改为admin进入admin界面，但需要对alg值修改为none，并删除签名部分删除用户同理 </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">opvow</div><div class="author-info-description">opvow's notebook</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">39</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">31</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/opvow"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/opvow" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFJWT"><span class="toc-number">1.</span> <span class="toc-text">什么是JWT</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">JWT格式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#jwt%E7%AD%BE%E5%90%8D"><span class="toc-number">3.</span> <span class="toc-text">jwt签名</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#jwt-jws-jwe"><span class="toc-number">4.</span> <span class="toc-text">jwt&#x2F;jws&#x2F;jwe</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT"><span class="toc-number">4.1.</span> <span class="toc-text">JWT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWS"><span class="toc-number">4.2.</span> <span class="toc-text">JWS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWE"><span class="toc-number">4.3.</span> <span class="toc-text">JWE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JWE%E7%94%9F%E6%88%90"><span class="toc-number">4.3.1.</span> <span class="toc-text">JWE生成</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT%E6%94%BB%E5%87%BB"><span class="toc-number">5.</span> <span class="toc-text">JWT攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E6%94%BB%E5%87%BB"><span class="toc-number">5.1.</span> <span class="toc-text">算法攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%86%E9%92%A5%E6%B3%84%E9%9C%B2"><span class="toc-number">5.2.</span> <span class="toc-text">密钥泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A4%E7%89%8C%E7%AF%A1%E6%94%B9"><span class="toc-number">5.3.</span> <span class="toc-text">令牌篡改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#exp%E7%BB%95%E8%BF%87"><span class="toc-number">5.4.</span> <span class="toc-text">exp绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#token%E9%87%8D%E6%94%BE"><span class="toc-number">5.5.</span> <span class="toc-text">token重放</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-number">5.6.</span> <span class="toc-text">不安全的存储</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">5.7.</span> <span class="toc-text">信息泄露</span></a></li></ol></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>系列文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/d0e26b4a.html" title="Portswigger-JWT-LAB-3"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Portswigger-JWT-LAB-3"></a><div class="content"><a class="title" href="/posts/d0e26b4a.html" title="Portswigger-JWT-LAB-3">Portswigger-JWT-LAB-3</a><time datetime="2024-11-15T10:25:48.000Z" title="发表于 2024-11-15 18:25:48">2024-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/a7e55bdc.html" title="Portswigger-JWT-LAB-2"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Portswigger-JWT-LAB-2"></a><div class="content"><a class="title" href="/posts/a7e55bdc.html" title="Portswigger-JWT-LAB-2">Portswigger-JWT-LAB-2</a><time datetime="2024-11-15T09:57:41.000Z" title="发表于 2024-11-15 17:57:41">2024-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/962f5710.html" title="Portswigger-JWT-LAB-1"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Portswigger-JWT-LAB-1"></a><div class="content"><a class="title" href="/posts/962f5710.html" title="Portswigger-JWT-LAB-1">Portswigger-JWT-LAB-1</a><time datetime="2024-11-15T04:53:54.000Z" title="发表于 2024-11-15 12:53:54">2024-11-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/cf3c54f2.html" title="认识JWT"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="认识JWT"></a><div class="content"><a class="title" href="/posts/cf3c54f2.html" title="认识JWT">认识JWT</a><time datetime="2024-10-29T05:11:52.000Z" title="发表于 2024-10-29 13:11:52">2024-10-29</time></div></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/e5da2ca1.html" title="sqlmap"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sqlmap"/></a><div class="content"><a class="title" href="/posts/e5da2ca1.html" title="sqlmap">sqlmap</a><time datetime="2024-12-03T07:36:53.000Z" title="发表于 2024-12-03 15:36:53">2024-12-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/fe1704c8.html" title="内网穿透工具FRP"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网穿透工具FRP"/></a><div class="content"><a class="title" href="/posts/fe1704c8.html" title="内网穿透工具FRP">内网穿透工具FRP</a><time datetime="2024-11-29T06:06:13.000Z" title="发表于 2024-11-29 14:06:13">2024-11-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/1dabe8f3.html" title="内网基础知识记录"><img src="/img/post_cover/default.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="内网基础知识记录"/></a><div class="content"><a class="title" href="/posts/1dabe8f3.html" title="内网基础知识记录">内网基础知识记录</a><time datetime="2024-11-27T06:19:43.000Z" title="发表于 2024-11-27 14:19:43">2024-11-27</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2024 By opvow</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://opvow.github.io">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"></div><script async src="/js/title_change.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/lite/builds/browser.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script></div></div></body></html>